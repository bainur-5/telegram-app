import { state, setState } from '../store.js';
const ru='/src/assets/flag_ru-4x3.svg',gb='/src/assets/flag_gb-4x3.svg',cn='/src/assets/flag_cn-4x3.svg';
const langs=[{code:'en',label:'English',emoji:`<img src="${gb}" alt="EN" />`},{code:'ru',label:'Русский',emoji:`<img src="${ru}" alt="RU" />`},{code:'empty',label:'Скоро',emoji:'',disabled:true},{code:'zh',label:'中文',emoji:`<img src="${cn}" alt="ZH" />`}];
export function renderProfile(){const p=state.profile; return `<main class="profile-settings"><section class="profile-settings__block"><h2 class="profile-settings__title">История</h2><div class="ps-history"><button type="button" class="ps-history__link"><span class="ps-history__text">История депозитов</span><span class="ps-history__arrow">→</span></button><button type="button" class="ps-history__link"><span class="ps-history__text">История выводов</span><span class="ps-history__arrow">→</span></button></div></section><section class="profile-settings__block"><h2 class="profile-settings__title">Настройки</h2><section class="ps-notify"><h3 class="ps-notify__title">Уведомления</h3><p class="ps-notify__subtitle">Выберите, какие уведомления получать</p><div class="ps-notify__list">${p.notifications.map(i=>`<div class="ps-notify__row"><div class="ps-notify__left"><p class="ps-notify__name">${i.title}</p><p class="ps-notify__desc">${i.description}</p></div><button type="button" class="ps-switch ${i.enabled?'is-on':''}" role="switch" aria-checked="${i.enabled}" data-notify="${i.id}" aria-label="${i.title}"></button></div>`).join('')}</div></section><section class="ps-language"><div class="ps-language__row"><p class="ps-language__title">Язык</p><div class="ps-language__grid">${langs.map(o=>`<button type="button" class="ps-language__btn ${p.activeLanguage===o.code?'is-active':''}" data-lang="${o.code}" ${o.disabled?'disabled':''} title="${o.label}" aria-label="${o.label}">${o.emoji||'<span aria-hidden>—</span>'}</button>`).join('')}</div></div></section></section></main>`}
export function bindProfile(root){root.querySelectorAll('[data-notify]').forEach(b=>b.onclick=()=>setState(s=>{const i=s.profile.notifications.find(n=>n.id===b.dataset.notify); if(i) i.enabled=!i.enabled;})); root.querySelectorAll('[data-lang]').forEach(b=>b.onclick=()=>!b.disabled&&setState(s=>{s.profile.activeLanguage=b.dataset.lang;}));}
